CREATE TABLE LOAN
(ACCNO INT,
CUSTNAME varchar(15),
LOANAMOUNT numeric,
INSTALLMENTS INT,
INT_RATE INT,
STARTDATE VARCHAR(66),
INTEREST NUMERIC);
TRUNCATE TABLE LOAN;
DROP TABLE LOAN;
ALTER TABLE LOAN ADD COLUMN CAT INT;
INSERT INTO LOAN (ACCNO,CUSTNAME,LOANAMOUNT,INSTALLMENTS,INT_RATE,STARTDATE) VALUES (1001,'R.K GUPTA',300000,36,12,'JULY 19,2009'),
(1002,'S P SHARMA',500000,48,10,'MARCH 22,2008'),(1004,'MP YADAV',800000,60,10,'JUNE 12,2008'),(1005,'SP SINHA',200000,36,12.50,'MARCH 1,2010'),(1006,'P SHARMA',700000,60,12.50,'MAY 3,2008');

INSERT INTO LOAN (ACCNO,CUSTNAME,LOANAMOUNT,INSTALLMENTS,STARTDATE) VALUES (1003,'KP JAIN',300000,36,'AUGUST 3,2007'),(1007,'KS DHALL',500000,48,'MAY 3,2008');

UPDATE LOAN SET INT_RATE=11.50 WHERE ACCNO=1003;
UPDATE LOAN SET INT_RATE=11.50 WHERE ACCNO=1007;
SELECT ACCNO,CUSTNAME,LOANAMOUNT,STARTDATE,INT_RATE+.5 FROM LOAN WHERE LOANAMOUNT>400000;
UPDATE LOAN SET INTEREST=(LOANAMOUNT *INT_RATE*INSTALLMENTS)/(12*100);

DELETE FROM LOAN WHERE CUSTNAME LIKE 'K%';

/*  DEMO ALTERING TABLE ALTER TABLE LOAN DROP COLUMN STARTDATE;
ALTER TABLE LOAN
ADD STARTDATE DATE NOT NULL;
UPDATE LOAN 
SET STARTDATE='2009-07-19' WHERE ACCNO='1001';
UPDATE LOAN 
SET STARTDATE='2008-03-22' WHERE ACCNO='1002';
UPDATE LOAN 
SET STARTDATE='2007-08-03' WHERE ACCNO='1003';
UPDATE LOAN 
SET STARTDATE='2008-06-12' WHERE ACCNO='1004';
UPDATE LOAN 
SET STARTDATE='2010-03-01' WHERE ACCNO='1005';
UPDATE LOAN 
SET STARTDATE='2008-05-06' WHERE ACCNO='1006';
UPDATE LOAN 
SET STARTDATE='2008-05-03' WHERE ACCNO='1007';*/
DELETE FROM LOAN WHERE STARTDATE<'2008-01-01';
SELECT *FROM LOAN;
SELECT * FROM LOAN WHERE INSTALLMENTS<40;
SELECT ACCNO,LOANAMOUNT from LOAN WHERE
STARTDATE<'2009-04-01';
SELECT INT_RATE from LOAN WHERE
STARTDATE<'2009-04-01';
SELECT ACCNO,CUSTNAME,LOANAMOUNT FROM LOAN WHERE CUSTNAME LIKE
'%SHARMA';
SELECT LOANAMOUNT FROM LOAN WHERE CUSTNAME
LIKE '%A';
SELECT ACCNO,CUSTNAME,LOANAMOUNT FROM LOAN WHERE CUSTNAME LIKE
'%A%';
SELECT ACCNO,CUSTNAME,LOANAMOUNT FROM LOAN WHERE CUSTNAME NOT LIKE
'%P%';
DESCRIBE LOAN;

SELECT * FROM LOAN ORDER BY LOANAMOUNT ;
SELECT * FROM LOAN ORDER BY STARTDATE DESC ;
SELECT * FROM LOAN ORDER BY LOANAMOUNT,STARTDATE DESC ;
SELECT ACCNO,CUSTNAME,LOANAMOUNT FROM LOAN WHERE CUSTNAME
LIKE '%K';
SELECT *FROM LOAN WHERE INT_RATE IS NULL;
SELECT *FROM LOAN WHERE INT_RATE IS  NOT NULL;
SELECT distinct LOANAMOUNT FROM LOAN ;
SELECT * FROM LOAN where STARTDATE >'2008-12-31' and  INSTALLMENTS >36;
SELECT CUSTNAME,LOANAMOUNT FROM LOAN where LOANAMOUNT <500000 or  INT_RATE >12;
SELECT * FROM LOAN where year(STARTDATE)='2009';
SELECT * FROM LOAN where LOANAMOUNT BETWEEN 400000 and  500000;
SELECT CUSTNAME,LOANAMOUNT FROM LOAN where INSTALLMENTS IN(26,36,48);

 SELECT CUSTNAME,LOANAMOUNT,INT_RATE,
 CASE WHEN INT_RATE  IS NULL THEN '0' ELSE INT_RATE END FROM LOAN;
SELECT CUSTNAME,LOANAMOUNT,INT_RATE,
 CASE WHEN INT_RATE  IS NULL THEN 'No Interest' ELSE INT_RATE END FROM LOAN;






