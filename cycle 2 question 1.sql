CREATE TABLE SAILORS 
(
SID INT,SNAME VARCHAR(30),RATING INT,AGE INT);
INSERT INTO SAILORS VALUES (22,'DUSTIN',7,45),(29,'BRUTAS',1,33),(31,'LUBBER',8,55),(32,'ANDY',8,25),
(58,'RUSTY',10,35),(64,'HORATIO',7,35),(71,'ZORBA',10,16),(74,'HORATIO',9,35),(85,'ART',3,26),(95,'BOB',3,64);
CREATE TABLE BOATS 
(
BID INT,BNAME VARCHAR(40),COLOR VARCHAR(33));
INSERT INTO BOATS VALUES(101,'INTERLAKE','BLUE'),(102,'INTERLAKE','RED'),(103,'CLIPPER','GREEN'),(104,'MARINE','RED');
CREATE TABLE RESERVES (
SID INT,BID INT,DAY DATE);
SELECT * FROM RESERVES;
INSERT INTO RESERVES VALUES (22,101,'1998-10-10'),(22,102,'1998-10-10');
INSERT INTO RESERVES VALUES (22,103,'1998-08-10'),(22,104,'1998-07-10'),(31,102,'1998-10-11'),(31,103,'1998-06-11'),
(31,104,'1998-12-11'),(64,101,'1998-05-09'),(64,102,'1998-08-09'),(74,103,'1998-08-09');
SELECT SNAME,AGE FROM SAILORS;
SELECT *FROM SAILORS,RESERVES  WHERE SAILORS.SID=RESERVES.SID AND BID=101;
SELECT *FROM SAILORS WHERE RATING>7;
SELECT  SNAME FROM SAILORS,RESERVES  WHERE SAILORS.SID=RESERVES.SID AND BID=103;
SELECT DISTINCT SNAME FROM SAILORS,RESERVES,BOATS  WHERE SAILORS.SID=RESERVES.SID AND BOATS.BID   = RESERVES.BID AND COLOR='RED';
SELECT DISTINCT SNAME FROM SAILORS,RESERVES,BOATS  WHERE SAILORS.SID=RESERVES.SID AND BOATS.BID   = RESERVES.BID AND (COLOR='RED' OR COLOR='GREEN');

SELECT DISTINCT COLOR FROM SAILORS,RESERVES,BOATS  WHERE SAILORS.SID=RESERVES.SID AND BOATS.BID   = RESERVES.BID AND SNAME='LUBBER';
SELECT DISTINCT SNAME FROM SAILORS,RESERVES,BOATS  WHERE COLOR='RED'  AND  SAILORS.SID=RESERVES.SID AND BOATS.BID   = RESERVES.BID
 IN( SELECT DISTINCT SNAME FROM SAILORS,RESERVES,BOATS 
 WHERE SAILORS.SID=RESERVES.SID AND BOATS.BID   = RESERVES.BID 
 AND COLOR='GREEN');
SELECT DISTINCT SNAME FROM SAILORS,RESERVES  WHERE SAILORS.SID=RESERVES.SID ;
SELECT SNAME ,RESERVES.SID FROM RESERVES,SAILORS WHERE SAILORS.SID=RESERVES.SID GROUP BY DAY,
 SNAME ,RESERVES.SID HAVING COUNT(DAY)>1 ;
 SELECT SNAME,AGE FROM SAILORS WHERE AGE  =(SELECT MIN(AGE) FROM SAILORS  ) ;
 SELECT SNAME FROM SAILORS WHERE RATING > (SELECT MAX(RATING ) FROM SAILORS WHERE SNAME = 'HORATIO');
SELECT SNAME,SID FROM (SELECT SNAME,RESERVES.SID COUNT(BID) AS id FROM RESERVES,SAILORS WHERE 
SAILORS.SID=RESERVES.SID GROUP BY RESERVES.SID,SNAME) 
WHERE id =( SELECT COUNT(BID) FROM BOATS);
SELECT COUNT(C.SNAME) FROM (SELECT DISTINCT SNAME FROM SAILORS) C;
SELECT AVG(AGE) FROM SAILORS;
SELECT RATING,AVG(AGE) FROM SAILORS GROUP BY RATING;
SELECT A.RATING,B.MEAN FROM 
  (SELECT COUNT(SNAME) AS NUM,RATING FROM SAILORS
 GROUP BY RATING HAVING COUNT(sname)>1 ) A, 
(SELECT RATING,AVG(age) AS mean FROM SAILORS  GROUP BY RATING ) B WHERE A.RATING = B.RATING;





